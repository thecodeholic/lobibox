var Lobibox=Lobibox||{};!function(){function o(o,t){this.$input=null,this.$type="prompt",this.$promptType=o,t=$.extend({},Lobibox.prompt.DEFAULT_OPTIONS,t),this.$options=this._processInput(t),this._init(),this.debug(this)}function t(o){this.$type="confirm",this.$options=this._processInput(o),this._init(),this.debug(this)}function s(o,t){this.$type=o,this.$options=this._processInput(t),this._init(),this.debug(this)}function n(o){this.$type="progress",this.$progressBarElement=null,this.$options=this._processInput(o),this.$progress=0,this._init(),this.debug(this)}function i(o,t){this.$type=o,this.$options=this._processInput(t),this._init(),this.debug(this)}Lobibox.prompt=function(t,s){return new o(t,s)},Lobibox.confirm=function(o){return new t(o)},Lobibox.progress=function(o){return new n(o)},Lobibox.error={},Lobibox.success={},Lobibox.warning={},Lobibox.info={},Lobibox.alert=function(o,t){return["success","error","warning","info"].indexOf(o)>-1?new s(o,t):void 0},Lobibox.window=function(o){return new i("window",o)};var e={$type:null,$el:null,$options:null,debug:function(){this.$options.debug&&window.console.debug.apply(window.console,arguments)},_processInput:function(o){if($.isArray(o.buttons)){for(var t={},s=0;s<o.buttons.length;s++){var n=Lobibox.base.OPTIONS.buttons[o.buttons[s]];t[o.buttons[s]]=n}o.buttons=t}o.customBtnClass=o.customBtnClass?o.customBtnClass:Lobibox.base.DEFAULTS.customBtnClass;for(var s in o.buttons){var n=o.buttons[s];o.buttons.hasOwnProperty(s)&&(n=$.extend({},Lobibox.base.OPTIONS.buttons[s],n),n["class"]||(n["class"]=o.customBtnClass)),o.buttons[s]=n}return o=$.extend({},Lobibox.base.DEFAULTS,o),void 0===o.showClass&&(o.showClass=Lobibox.base.OPTIONS.showClass),void 0===o.hideClass&&(o.hideClass=Lobibox.base.OPTIONS.hideClass),void 0===o.baseClass&&(o.baseClass=Lobibox.base.OPTIONS.baseClass),void 0===o.delayToRemove&&(o.delayToRemove=Lobibox.base.OPTIONS.delayToRemove),o},_init:function(){var o=this;o._createMarkup(),o.setTitle(o.$options.title),o.$options.draggable&&!o._isMobileScreen()&&(o.$el.addClass("draggable"),o._enableDrag()),o.$options.closeButton&&o._addCloseButton(),o.$options.closeOnEsc&&$(document).on("keyup.lobibox",function(t){27===t.which&&o.destroy()}),o.$options.baseClass&&o.$el.addClass(o.$options.baseClass),o.$options.showClass&&(o.$el.removeClass(o.$options.hideClass),o.$el.addClass(o.$options.showClass)),o.$el.data("lobibox",o)},_calculatePosition:function(o){var t,s=this;t="top"===o?30:"bottom"===o?$(window).outerHeight()-s.$el.outerHeight()-30:($(window).outerHeight()-s.$el.outerHeight())/2;var n=($(window).outerWidth()-s.$el.outerWidth())/2;return{left:n,top:t}},_createButton:function(o,t){var s=this,n=$("<button></button>").addClass(t["class"]).attr("data-type",o).html(t.text);return s.$options.callback&&"function"==typeof s.$options.callback&&n.on("click.lobibox",function(t){var n=$(this);s.$options.buttons[o]&&s.$options.buttons[o].closeOnClick&&s.destroy(),s.$options.callback(s,n.data("type"),t)}),n.click(function(){s.$options.buttons[o]&&s.$options.buttons[o].closeOnClick&&s.destroy()}),n},_generateButtons:function(){var o=this,t=[];for(var s in o.$options.buttons)if(o.$options.buttons.hasOwnProperty(s)){var n=o.$options.buttons[s],i=o._createButton(s,n);t.push(i)}return t},_createMarkup:function(){var o=this,t=$('<div class="lobibox"></div>');t.attr("data-is-modal",o.$options.modal);var s=$('<div class="lobibox-header"></div>').append('<span class="lobibox-title"></span>'),n=$('<div class="lobibox-body"></div>');if(t.append(s),t.append(n),o.$options.buttons&&!$.isEmptyObject(o.$options.buttons)){var i=$('<div class="lobibox-footer"></div>');i.append(o._generateButtons()),t.append(i),Lobibox.base.OPTIONS.buttonsAlign.indexOf(o.$options.buttonsAlign)>-1&&i.addClass("text-"+o.$options.buttonsAlign)}o.$el=t.addClass(Lobibox.base.OPTIONS.modalClasses[o.$type])},_setSize:function(){var o=this;o.setWidth(o.$options.width),o.setHeight("auto"===o.$options.height?o.$el.outerHeight():o.$options.height)},_calculateBodyHeight:function(o){var t=this,s=t.$el.find(".lobibox-header").outerHeight(),n=t.$el.find(".lobibox-footer").outerHeight();return o-(s?s:0)-(n?n:0)},_addBackdrop:function(){0===$(".lobibox-backdrop").length&&$("body").append('<div class="lobibox-backdrop"></div>')},_triggerEvent:function(o){var t=this;t.$options[o]&&"function"==typeof t.$options[o]&&t.$options[o](t)},_calculateWidth:function(o){var t=this;return o=Math.min($(window).outerWidth(),o),o===$(window).outerWidth()&&(o-=2*t.$options.horizontalOffset),o},_calculateHeight:function(o){return Math.min($(window).outerHeight(),o)},_addCloseButton:function(){var o=this,t=$('<span class="btn-close">&times;</span>');o.$el.find(".lobibox-header").append(t),t.on("click.lobibox",function(){o.destroy()})},_position:function(){var o=this;o._setSize();var t=o._calculatePosition();o.setPosition(t.left,t.top)},_isMobileScreen:function(){return $(window).outerWidth()<768?!0:!1},_enableDrag:function(){var o=this.$el,t=o.find(".lobibox-header");t.on("mousedown.lobibox",function(t){o.attr("offset-left",t.offsetX),o.attr("offset-top",t.offsetY),o.attr("allow-drag","true")}),$(document).on("mouseup.lobibox",function(){o.attr("allow-drag","false")}),$(document).on("mousemove.lobibox",function(t){if("true"===o.attr("allow-drag")){var s=t.clientX-parseInt(o.attr("offset-left"),10),n=t.clientY-parseInt(o.attr("offset-top"),10);o.css({left:s,top:n})}})},_setContent:function(o){var t=this;return t.$el.find(".lobibox-body").html(o),t},hide:function(){function o(){t.$el.addClass("lobibox-hidden"),0===$(".lobibox[data-is-modal=true]:not(.lobibox-hidden)").length&&($(".lobibox-backdrop").remove(),$("body").removeClass(Lobibox.base.OPTIONS.bodyClass))}var t=this;return t.$options.hideClass?(t.$el.removeClass(t.$options.showClass),t.$el.addClass(t.$options.hideClass),setTimeout(function(){o()},t.$options.delayToRemove)):o(),this},destroy:function(){function o(){t.$el.remove(),0===$(".lobibox[data-is-modal=true]").length&&($(".lobibox-backdrop").remove(),$("body").removeClass(Lobibox.base.OPTIONS.bodyClass)),t._triggerEvent("closed")}var t=this;return t._triggerEvent("beforeClose"),t.$options.hideClass?(t.$el.removeClass(t.$options.showClass),t.$el.addClass(t.$options.hideClass),setTimeout(function(){o()},t.$options.delayToRemove)):o(),this},setWidth:function(o){return o=this._calculateWidth(o),this.$el.css("width",o),this},setHeight:function(o){var t=this;o=t._calculateHeight(o),t.$el.css("height",o);var s=t._calculateBodyHeight(t.$el.innerHeight());return t.$el.find(".lobibox-body").css("height",s),t},setSize:function(o,t){var s=this;return s.setWidth(o),s.setHeight(t),s},setPosition:function(o,t){var s,n=this;return"number"==typeof o&&"number"==typeof t?s={left:o,top:t}:"string"==typeof o&&(s=n._calculatePosition(o)),n.$el.css(s),n},setTitle:function(o){var t=this;return t.$el.find(".lobibox-title").html(o),t},getTitle:function(){var o=this;return o.$el.find(".lobibox-title").html()},show:function(){var o=this;return o._triggerEvent("onShow"),o.$el.removeClass("lobibox-hidden"),$("body").append(o.$el),o.$options.modal&&($("body").addClass(Lobibox.base.OPTIONS.bodyClass),o._addBackdrop()),o._triggerEvent("shown"),o}};Lobibox.base={},Lobibox.base.OPTIONS={bodyClass:"lobibox-open",modalClasses:{error:"lobibox-error",success:"lobibox-success",info:"lobibox-info",warning:"lobibox-warning",confirm:"lobibox-confirm",progress:"lobibox-progress",prompt:"lobibox-prompt","default":"lobibox-default",window:"lobibox-window"},buttonsAlign:["left","center","right"],buttons:{ok:{"class":"lobibox-btn lobibox-btn-default",text:"OK",closeOnClick:!0},cancel:{"class":"lobibox-btn lobibox-btn-cancel",text:"Cancel",closeOnClick:!0},yes:{"class":"lobibox-btn lobibox-btn-yes",text:"Yes",closeOnClick:!0},no:{"class":"lobibox-btn lobibox-btn-no",text:"No",closeOnClick:!0}}},Lobibox.base.DEFAULTS={horizontalOffset:5,width:600,height:"auto",closeButton:!0,draggable:!1,customBtnClass:"lobibox-btn lobibox-btn-default",modal:!0,debug:!0,buttonsAlign:"center",closeOnEsc:!0,delayToRemove:200,baseClass:"animated-super-fast",showClass:"zoomIn",hideClass:"zoomOut",onShow:null,shown:null,beforeClose:null,closed:null},o.prototype=$.extend({},e,{constructor:o,_processInput:function(t){var s=this,n=e._processInput.call(s,t);return n.buttons={ok:Lobibox.base.OPTIONS.buttons.ok,cancel:Lobibox.base.OPTIONS.buttons.cancel},t=$.extend({},n,o.DEFAULT_OPTIONS,t)},_init:function(){var o=this;e._init.call(o),o.show(),o._setContent(o._createInput()),o._position(),o.$input.focus()},_createInput:function(){var o,t=this;t.$options.multiline?(t.$input=$("<textarea></textarea>"),t.$input.attr("rows",t.$options.lines)):t.$input=$('<input type="'+t.$promptType+'"/>'),t.$input.addClass("lobibox-input"),t.$input.attr(t.$options.attrs),t.$options.value&&t.setValue(t.$options.value),t.$options.label&&(o=$("<label>"+t.$options.label+"</label>"));var s=$("<div></div>").append(o,t.$input);return s},setValue:function(o){return this.$input.val(o),this},getValue:function(){return this.$input.val()}}),o.DEFAULT_OPTIONS={width:400,attrs:{},value:"",multiline:!1,lines:3,type:"text",label:""},t.prototype=$.extend({},e,{constructor:t,_processInput:function(o){var t=this,s=e._processInput.call(t,o);return s.buttons={yes:Lobibox.base.OPTIONS.buttons.yes,no:Lobibox.base.OPTIONS.buttons.no},o=$.extend({},s,Lobibox.confirm.DEFAULTS,o)},_init:function(){var o=this;e._init.call(o),o.show();var t=$("<div></div>");window.console.log(o.$options),o.$options.iconClass&&t.append($('<div class="lobibox-icon-wrapper"></div>').append('<i class="lobibox-icon '+o.$options.iconClass+'"></i>')),t.append('<div class="lobibox-body-text-wrapper"><span class="lobibox-body-text">'+o.$options.msg+"</span></div>"),o._setContent(t.html()),o._position()}}),Lobibox.confirm.DEFAULTS={title:"Question",width:500,iconClass:"glyphicon glyphicon-question-sign"},s.prototype=$.extend({},e,{constructor:s,_processInput:function(o){var t=this,s=e._processInput.call(t,o);return s.buttons={ok:Lobibox.base.OPTIONS.buttons.ok},o=$.extend({},s,Lobibox.alert.OPTIONS[t.$type],Lobibox.alert.DEFAULTS,o)},_init:function(){var o=this;e._init.call(o),o.show();var t=$("<div></div>");o.$options.iconClass&&t.append($('<div class="lobibox-icon-wrapper"></div>').append('<i class="lobibox-icon '+o.$options.iconClass+'"></i>')),t.append('<div class="lobibox-body-text-wrapper"><span class="lobibox-body-text">'+o.$options.msg+"</span></div>"),o._setContent(t.html()),o._position()}}),Lobibox.alert.OPTIONS={warning:{title:"Warning",iconClass:"glyphicon glyphicon-question-sign"},info:{title:"Information",iconClass:"glyphicon glyphicon-info-sign"},success:{title:"Success",iconClass:"glyphicon glyphicon-ok-sign"},error:{title:"Error",iconClass:"glyphicon glyphicon-remove-sign"}},Lobibox.alert.DEFAULTS={},n.prototype=$.extend({},e,{constructor:n,_processInput:function(o){var t=this,s=e._processInput.call(t,o);return o=$.extend({},s,Lobibox.progress.DEFAULTS,o)},_init:function(){var o=this;e._init.call(o),o.show(),o.$progressBarElement=o.$options.progressTpl?$(o.$options.progressTpl):o._createProgressbar();var t;o.$options.label&&(t=$("<label>"+o.$options.label+"</label>"));var s=$("<div></div>").append(t,o.$progressBarElement);o._setContent(s),o._position()},_createProgressbar:function(){var o=this,t=$('<div class="lobibox-progress-bar-wrapper lobibox-progress-outer"></div>').append('<div class="lobibox-progress-bar lobibox-progress-element"></div>');return o.$options.showProgressLabel&&t.append('<span class="lobibox-progress-text" data-role="progress-text"></span>'),t},setProgress:function(o){var t=this;if(100!==t.$progress)return o=Math.min(100,Math.max(0,o)),t.$progress=o,t._triggerEvent("progressUpdated"),100===t.$progress&&t._triggerEvent("progressCompleted"),t.$el.find(".lobibox-progress-element").css("width",o.toFixed(1)+"%"),t.$el.find('[data-role="progress-text"]').html(o.toFixed(1)+"%"),t},getProgress:function(){return this.$progress}}),Lobibox.progress.DEFAULTS={width:500,showProgressLabel:!0,label:"",progressTpl:!1,progressUpdated:null,progressCompleted:null},i.prototype=$.extend({},e,{constructor:i,_processInput:function(o){var t=this,s=e._processInput.call(t,o);return o.content&&"function"==typeof o.content&&(o.content=o.content()),o.content instanceof jQuery&&(o.content=o.content.clone()),o=$.extend({},s,Lobibox.window.DEFAULTS,o)},_init:function(){var o=this;e._init.call(o),o.setContent(o.$options.content),o.$options.url&&o.$options.autoload?(o.$options.showAfterLoad||(o.show(),o._position()),o.load(function(){o.$options.showAfterLoad&&(o.show(),o._position())})):(o.show(),o._position())},setParams:function(o){var t=this;return t.$options.params=o,t},getParams:function(){var o=this;return o.$options.params},setLoadMethod:function(o){var t=this;return t.$options.loadMethod=o,t},getLoadMethod:function(){var o=this;return o.$options.loadMethod},setContent:function(o){var t=this;return t.$options.content=o,t.$el.find(".lobibox-body").html("").append(o),t},getContent:function(){var o=this;return o.$options.content},setUrl:function(o){return this.$options.url=o,this},getUrl:function(){return this.$options.url},load:function(o){var t=this;return t.$options.url?($.ajax(t.$options.url,{method:t.$options.loadMethod,data:t.$options.params}).done(function(s){t.setContent(s),o&&"function"==typeof o&&o(s)}),t):t}}),Lobibox.window.DEFAULTS={width:480,height:600,content:"",url:"",draggable:!0,autoload:!0,loadMethod:"GET",showAfterLoad:!0,params:{}}}();